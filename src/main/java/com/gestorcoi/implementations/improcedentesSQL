WITH CTE_OCORRENCIAS AS (
    SELECT DISTINCT
        O.OCO_NUMERO || '-' || O.OCO_MES || '-' || O.OCO_ANO AS OCORRENCIA,
        O.OCO_ENDERECO AS ENDERECO,
        MTV.MRE_DESCRICAO AS MOTIVO,
        O.OCO_INF_ADICIONAIS AS INFORMACAO
    FROM OPERACAO.OCORRENCIA O
    LEFT JOIN OPERACAO.MOTIVO_DA_RECLAMACAO MTV 
        ON MTV.TB_MT_NR_ID = O.TB_MT_NR_ID
    WHERE 
        (
            O.OCO_INF_ADICIONAIS LIKE '%DISJUNTOR%' 
            OR O.OCO_INF_ADICIONAIS LIKE '%CHUVEIRO%' 
            OR O.OCO_INF_ADICIONAIS LIKE '%COMPREI%'
            OR O.OCO_INF_ADICIONAIS LIKE '%ARVORE%' 
            OR O.OCO_INF_ADICIONAIS LIKE '%GALHOS%' 
            OR O.OCO_INF_ADICIONAIS LIKE '%ÁRVORE%'
            OR O.OCO_INF_ADICIONAIS LIKE '%LUZ%' 
            OR O.OCO_INF_ADICIONAIS LIKE '%LUMINARIA%' 
            OR O.OCO_INF_ADICIONAIS LIKE '%LUMINÁRIA%'
            OR O.OCO_INF_ADICIONAIS LIKE '%CONDICIONADO%'
            OR O.OCO_INF_ADICIONAIS LIKE '%NORMAL%' 
            OR O.OCO_INF_ADICIONAIS LIKE '%NORMALIZOU%' 
            OR O.OCO_INF_ADICIONAIS LIKE '%NORMALIZADA%'
            OR O.OCO_INF_ADICIONAIS LIKE '%SUSPENSO%'
            OR O.OCO_INF_ADICIONAIS LIKE '%RELIGAMENTO%'
            OR O.OCO_INF_ADICIONAIS LIKE '%ABELHA%' 
            OR O.OCO_INF_ADICIONAIS LIKE '%PASSARINHO%' 
            OR O.OCO_INF_ADICIONAIS LIKE '%GATO%'
            OR O.OCO_INF_ADICIONAIS LIKE '%CORTE%'
            OR O.OCO_INF_ADICIONAIS LIKE '%TESTE%'
            OR O.OCO_INF_ADICIONAIS LIKE '%BAIRRO TODO%'
            OR O.OCO_INF_ADICIONAIS LIKE '%REGIÃO%'
            OR O.OCO_INF_ADICIONAIS LIKE '%RUA%'
        )
        AND O.OCO_DATA_NR BETWEEN TRUNC(SYSDATE) - 1 AND TRUNC(SYSDATE) + 1 - (1/86400)
        AND O.OCO_STATUS NOT IN ('F', 'V', 'T', 'A', 'C')
)
SELECT 
    MOTIVO, 
    OCORRENCIA, 
    ENDERECO, 
    INFORMACAO
FROM CTE_OCORRENCIAS
